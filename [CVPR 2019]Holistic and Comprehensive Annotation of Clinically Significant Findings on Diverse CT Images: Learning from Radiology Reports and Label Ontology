Holistic and Comprehensive Annotation of Clinically Significant Findings on Diverse CT Images: Learning from Radiology Reports and Label Ontology

1、Motivation
计算机辅助诊断（CAD）是医学图像处理领域的研究热点，目前已有许多应用于临床的商业软件包。近年来的研究进展，包括皮肤病变的自动分类、肝脏病变的检测、肺栓塞检测等使得深度学习在计算机辅助诊断中的应用受到越来越多的关注。其中病变分类是CAD研究的一项重要主题，经典的应用包括通过医学图像对肝脏病变和肺组织的类型进行分类、描述肺结节和乳腺肿块的细粒度属性，以及预测病变的恶性程度等。
目前病变分类的研究工作通常针对于一种特定的身体部位，如肺部、胸部、肝脏，其分类结果往往集中在一组有限的标签。因此，尚未探索覆盖不同身体部位的许多具有临床意义的病变标签。当有经验的放射科医生察看CT图像时，他们可以检测到身体各个部位的病变，并确定病变的详细信息。我们希望计算机能够识别出病变的具体位置、所属部位和形式，从而帮助医生全面了解病变的信息。其类似于计算机视觉中的多标签图像标记任务。然而，开发一个通用的或多用途的病变分类模型，能够以一种无缝的方式检测多种疾病类型，仍然是一个很大的挑战。这一框架对于构建放射学自动诊断与推理系统至关重要。
本文提出了一个病变标注网络 (LesaNet)，以在给定病变图像的情况下预测语义标签。该病变标注任务被视为多标签图像分类问题。基于医学影像的图像标注任务具有挑战性：1）放射学报告的格式通常为自由文本，因此从中提取的标签可能夹杂不必要的信息；2）有些标签很难区分或学习，例如相邻的身体部位、相似的类型和微妙的属性。3）标签的内容多样化且结构复杂。
2、Contribution
（1）研究了整体病变标注问题，并提出了一种以最少的人工注释就可以自动学习的框架；
（2）提出了一种从放射学报告中挖掘相关标签文本的算法；
（3）提出了一种有效的病变标注算法LesaNet，也可用于其他多标签图像的分类任务；
（4）为了充分利用基于本体论的医学知识，将标签关系引入LesaNet。

3、Model
（1）标签挖掘和本体构建
本文基于RadLex构建了病变本体，RadLex是用于标准化索引和检索放射信息的综合词典。本文的标签可分为三类：身体部位，类别和特征属性。病变本体中的标签是按层次结构组织的，他们之间形成有向图结构，有些标签则为互斥关系，这也意味着一个标签的存在表示其他标签的缺失，此规则有助于标注标签。
构建病变本体后，从DeepLesion的相关放射学报告中提取标签。在报告中，放射科医生描述了病变情况，并在图像中的病变区域进行编号和注释。本文将标注的句子用于文本挖掘与病变相关的标签。首先，使用NLTK工具标记该句子并对其进行词形化以获得其基本形式。然后，将预处理句子中的命名实体进行匹配，并根据它们的同义词将其标准化为标签。该模型将输出标签与注释之间的关系（无关，不确定和相关）的概率向量。
（2）病变注释网络（LesaNet）                                                    
1)多尺度多标签卷积神经网络
多标签学习的主要难点在于输出空间的爆炸增长，为了解决指数复杂度的标签空间，需要挖掘标签之间的相关性。
2)挖掘标签之间的关系
该模块包括两个部分：一是标签扩展，二是复杂样本挖掘。通过构建层次的标签关系，可以由子标签推断出父标签的属性。但当放射科医生没有描述病变的每个属性或忽略细小的身体部位时，即诊断报告中未提及其子标签，则标签扩展任务无法完成。本文提出RHEM算法将复杂样本自动化的筛选出来运用到模型训练中去，从而获得较好的模型效果。
3)分数传播层（SPL）
该传播层连接在LesaNet网络的最后，是一个全连接层，它使用线性变换矩阵精化预测分值，然后加权CE损失函数。SPL可以提高正相关标签的分值，抑制负相关标签的分值。
4)多标签三重态损失函数
对于CAD任务，可解释性非常重要。本文对算法进行分析，为其预测提供支撑依据。在对病变分类后，LesaNet可以在数据集中找出具有类似标签的病变，这将有助于医生更好地了解其预测结果。

4、Experiment
（1）数据集
DeepLesion数据集是NIHCC在《DeepLesion: Automated mining of large-scale lesion annotations and universal lesion detection with deep learning》中发表的迄今最大的CT医学病变图像数据集，弥补了计算机辅助检测领域和计算机辅助诊断领域中大规模标注的放射图像数据集的空白。DeepLesion数据集是从NIH的图片存档和通信系统（NIH PACS）中挖掘历史医学数据而开发的--它使用了来自存档医学图像中具有临床意义发现的注释（即书签），对书签的特性进行了分析、收集和排序。
在传统医学图像领域里，收集影像学资料的传统方法无法提供搜索引擎功能，解读图像信息需要丰富的临床经验和辅助技术。DeepLesion数据集解决了这一技术需求，通过其拥有的深度神经网络系统，辅助临床医生，甚至AI研发人员创建一个具有统一框架的大规模通用疾病数据搜索引擎和检测器。
DeepLesion多类别病变数据集可以用来开发自动化放射诊断的计算机辅助诊断系统，它拥有超过1万例病例研究中的32,000多个带注释的病变数据。DeepLesion数据集的图像包括多种病变类型，包括肾脏病变、骨病变、肺结节和淋巴结肿大等。除了病变检测之外，DeepLesion数据集还可以用于对病变进行分类，即根据查询字符串检索病变或根据数据集中的现有模式预测新病例中的病变恶化情况。
（2）评价指标
本文采用AUC作为模型的评价指标，AUC量化了ROC曲线的分类效果，这种分类效果是与概率、阈值紧密相关的，分类效果越好，AUC的值越大，那么输出的概率值也就越合理。但AUC是基于等级的度量指标，不涉及标签的分类决策，难以评估多标签分类中最终预测标签的准确率。因此，本文还计算了每个标签的准确率、召回率和F1值。

5、Conclusion
本文研究了病变标注问题，提出了一种从放射学报告和标签本体中自动学习临床有意义标签的框架。该网络不仅能提高病变分类的准确性，而且提供了论依据。未来的研究工作包括收集更多的数据，以更好地学习稀有和复杂的标签，并尝试整合更多的医学专业知识。

Question:
1、何谓本体？为什么在医学领域中需要应用本体？
文中多次出现ontology这个词，中文译为本体。感觉很抽象，本体论是一个哲学概念，是研究存在本质的哲学理论。在计算机界，本体是共享概念模型明确的形式化规范说明。本体的一个典型应用是语义网，语义网希望构建一个通用本体，提供一种计算机能够理解的、结构化的语义描述机制，及一系列推理规则以实现自动化推理。对于语义网而言，本体是一个形式化定义词语关系的规范文件。而疾病本体（disease ontology）旨在促进各种疾病及相关健康状况向特定医学代码的映射的本体。
本体应用在医学领域，提供了一种全面思考知识的方法，为了不断增加一些知识和改进实践提供框架。在查找资料中看到一段基于本体的整合电子病历的阐述，“本体能够帮助我们把数据转化为信息，最终转化为知识和智慧，帮我们作出更好的决策。本体为转移数据至知识提供了技术框架，这对于电子病历时代尤为重要。电子健康病历利用了各种标准来进行临床数据采集，将非结构化数据处理成结构化数据在医学始终是一个长期的工作。”他们研究并验证一种基于标准的数据架构，它能够让结构化和非结构化的数据被这种集成的电子病历使用，并用来和其他的数据比较和关联。

2、构建标签的关系图作为知识库是如何加入到模型的训练过程中？
3、Triplet Loss为什么适用于多分类任务？
Triplet Loss是深度学习中的一种损失函数，用于训练差异性较小的样本，如人脸等， Feed数据包括锚（Anchor）示例、正（Positive）示例、负（Negative）示例，通过优化锚示例与正示例的距离小于锚示例与负示例的距离，实现样本的相似性计算。
4、提取图像特征的VGG16模型在实验过程中是否已完成预训练？ 实验部分有待进一步了解。
 
